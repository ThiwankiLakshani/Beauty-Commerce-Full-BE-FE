{% extends "base.html" %}
{% block title %}{{ 'New' if not u else 'Edit' }} User â€” Admin{% endblock %}
{% block content %}
  <div class="bg-white/90 shadow-soft rounded-2xl p-6 max-w-2xl">
    <h1 class="text-2xl font-bold">{{ 'Create User' if not u else 'Edit User' }}</h1>
    <form class="mt-6 space-y-4" method="post" action="{{ url_for('users_create') if not u else url_for('users_update', user_id=u._id) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div><label class="block text-sm mb-1">Name</label><input name="name" value="{{ u.name if u else '' }}" class="w-full px-4 py-3 rounded-xl bg-gray-100" required></div>
      <div><label class="block text-sm mb-1">Email</label><input name="email" value="{{ u.email if u else '' }}" class="w-full px-4 py-3 rounded-xl bg-gray-100" type="email" required></div>
      <div>
        <label class="block text-sm mb-1">{{ 'Password' if not u else 'New Password (optional)' }}</label>
        <input name="new_password" type="password" class="w-full px-4 py-3 rounded-xl bg-gray-100" {% if not u %}required{% endif %}>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm mb-1">Role</label>
          <select name="role" class="w-full px-4 py-3 rounded-xl bg-gray-100">
            <option value="user" {% if u and u.role=='user' %}selected{% endif %}>User</option>
            <option value="admin" {% if u and u.role=='admin' %}selected{% endif %}>Admin</option>
          </select>
        </div>
        <div class="flex items-end">
          <label class="inline-flex items-center gap-2">
            <input type="checkbox" name="is_active" {% if not u or u.is_active %}checked{% endif %} class="h-4 w-4">
            <span class="text-sm">Active</span>
          </label>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <button class="px-4 py-2 rounded-xl bg-purple-600 text-white">{{ 'Create' if not u else 'Save Changes' }}</button>
        <a class="underline text-purple-700" href="{{ url_for('users_list') }}">Cancel</a>
      </div>
    </form>
  </div>
{% endblock %}
